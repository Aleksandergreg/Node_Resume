<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Express.js Documentation</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="../../assets/js/tailwind-config.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>

  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">


</head>
<body class="bg-secondary-50 antialiased text-secondary-800">
  <div class="min-h-screen flex">

    <div id="sidebar-container" class="flex-shrink-0"></div>

    <main class="flex-1 max-w-5xl mx-auto py-12 px-4 md:px-8">
      <div class="bg-white shadow-custom rounded-lg p-6 md:p-12">

        <div class="border-b border-secondary-200 pb-6 mb-10">
          <h1 class="text-3xl font-bold mb-6 text-primary-700">Creating a server on express</h1>
        </div>

        <div class="prose lg:prose-lg max-w-none">
          <p>
            To create a server on Express, we need to import the Express module, which can be found under our node_modules generated by our npm install when declared in our package.json. There are two ways of solving this issue, either using the CommonJS module, or by the ES modules.
          </p>

          <p class="font-semibold">The first way, using the CommonJS module, would be done like this:</p>

          <pre class="bg-secondary-900 text-white p-5 rounded-lg mb-6 border-l-4 border-primary-500 overflow-x-auto">
<code class="language-javascript">const express = require(‘express’);
const app = express();</code>
          </pre>

          <p>
            The other way of doing it is using the ES modules. Before we can use this solution, we need to add the type:module inside our package.json. This should be done like this:
          </p>

          <pre class="bg-secondary-900 text-white p-5 rounded-lg mb-6 border-l-4 border-primary-500 overflow-x-auto">
<code class="language-json">{
 "type": "module",
 "dependencies": {
   "express": "^4.21.2"
 }
}</code>
          </pre>

          <p>
            Then in our file we need to import express as a module, and then initialize it like we did before:
          </p>

          <pre class="bg-secondary-900 text-white p-5 rounded-lg mb-6 border-l-4 border-primary-500 overflow-x-auto">
<code class="language-javascript">import express from ‘express’;
const app = express();</code>
          </pre>

          <p>
            Since we are using modern JavaScript ES6 and forward,  we will always use import, but it is good knowledge to know about the CommonJS way, if you ever see yourself working on older Node.js projects.
          </p>

          <p>
            Now we need to make our server run on a port. This is done by adding a port by using the build in method for our app called app.listen:
          </p>

          <pre class="bg-secondary-900 text-white p-5 rounded-lg mb-6 border-l-4 border-primary-500 overflow-x-auto">
<code class="language-javascript">PORT = 8080;
app.listen(PORT, ( ) => console.log(“Server is running on port, PORT));</code>
          </pre>

          <p>
            Now we can run our server on port 8080, using express. There are some modifications to our server that we would like to implement in most cases though, for it to be able to handle various tasks. The first thing we would like to do, depending on the functionality of our application, is to enable Express middleware that makes it possible for us to parse JSON request bodies. So why is this needed and how is it done? The client wants to send JSON data in a request body to our server, Node.js will not understand this:
          </p>

          <pre class="bg-secondary-900 text-white p-5 rounded-lg mb-6 border-l-4 border-primary-500 overflow-x-auto">
<code class="language-json">{
  "name": "Alice",
  "age": 25
}</code>
          </pre>

          <p>
            So if we do:
          </p>

          <pre class="bg-secondary-900 text-white p-5 rounded-lg mb-6 border-l-4 border-primary-500 overflow-x-auto">
<code class="language-javascript">app.post(‘/data’, (req, res) => {
console.log(req.body); //undefined 
res.send(“Recieved);
});</code>
          </pre>

          <p>
            This is as said not possible as the req.body with the raw JSON body is not parsed.
          </p>

          <p>
            if we instead add the middleware to our program like this, now the server can parse the JSON body:
          </p>

          <pre class="bg-secondary-900 text-white p-5 rounded-lg mb-6 border-l-4 border-primary-500 overflow-x-auto">
<code class="language-javascript">app.use(express.json()); // enables JSON parsing

app.post(‘/data’, (req, res) => {
console.log(req.body); // { name: 'Alice', age: 25 }
res.send(“Recieved);
});</code>
          </pre>

          <p>
            So whenever we have a POST, PUT or PATCH request that sends JSON inside of the request body, we need to implement this middleware. If we just have an application with simple GET requests, this is not needed.
          </p>

          <h2 class="text-3xl font-bold mb-6 text-primary-700">Serving static files in Express</h2>

          <p>
            Now that we have created our server, we need to think about our project structure before starting to build our full stack application. A good way to start is to think about which files are client files and which are server files. All the files that you define as client side, should be placed inside a public folder. A good way of organizing this is to make a subfolder inside of the public folder, for e.g frontpage, movies, bookings etc. if we take a basis in a cinema booking application. Inside the public folder we will also create a subfolder called assets, in this folder we can then have another set of subfolders for everything that are shared across multiple pages e.g css, images and js. This gives a good logical structure, and is also very scalable, while keeping a clean project structure.
          </p>

          <p>
            The way we can do this is to put the following code in our main app.js file:
          </p>

          <pre class="bg-secondary-900 text-white p-5 rounded-lg mb-6 border-l-4 border-primary-500 overflow-x-auto">
<code class="language-javascript">app.use(express.static(‘public’));</code>
          </pre>

          <p>
            This makes the file inside “public” accessible to the client. Without this, Express does not serve static files, and only API routes are available. If we accidentally put server files inside public, they could be accessed by anyone. This would create a big security risk. Let's say we put our public/database-config.js, they could be accessed by anyone. Everything that’s not inside of the public folder should be serverfiles, like util, app.js packagelock-json, package.json and .gitignore.
          </p>

        </div> 
      </div> 
    </main>
  </div>

  <script type="module" src="../assets/js/sidebar.js"></script>
</body>
</html>
